//------------------------------------------------------------------------------
// JavaScript Curve / Circle / Arch Carousel v1.0.0 Project - http://jshibernate.com/
// Copyright (C) 2013 JsHibernate (http://jshibernate.com). all rights reserved.
// This project is licensed under the Microsoft Reciprocal License (Ms-RL)
// This license can be found here: http://jshibernate.com/
// Mail To: murugasen.g@gmail.com
//-------------------------------------------------------------------------------
function Carousel(){this.init=function(c){this.options=c||{};this.options.height=this.options.height||200;this.options.width=this.options.width||650;this.horizontalRadious=this.options.width/2;this.verticalRadious=this.options.height/2;this.minLimit=this.horizontalRadious-((this.options.width/3)/2);this.maxLimit=this.horizontalRadious+((this.options.width/3)/2);this.speed=this.options.speed||0;this.isRunning=false;this.direction=0;this.accelerate=0;this.loop=this.options.loop||false;this.timer=null;this.stoptimer=null;var b=7,a=$("#"+this.options.id);for(var d=(Math.PI/8);d<(Math.PI);(d=d+(Math.PI/8))){$(a.children("div")[b-1]).css(this.getStyle(d));$(a.children("div")[b-1]).attr("data-index",b);b--}a.mousemove(function(f){carousel.handleEvent(f,"mouseover")});a.mouseenter(function(f){carousel.handleEvent(f,"mouseover")});a.mouseleave(function(f){carousel.handleEvent(f,"mouseout")})};this.getStyle=function(d){var c=((Math.cos(d)*this.horizontalRadious)+this.horizontalRadious);var b=((Math.sin(d)*this.verticalRadious)+this.verticalRadious);var a=b/this.options.height;if(a<1){a-=0.3}if(d==(Math.PI/8)||d==(Math.PI-(Math.PI/8))){a=0.1}if(d<(Math.PI/8)||d>=Math.PI){a=0}c+=$("#"+this.options.id).position().left;b+=$("#"+this.options.id).position().top;return{left:c+"px",top:b+"px",opacity:a}};this.play=function(){if(this.options.maxCount<=7){return}if(!this.isRunning&&this.accelerate>0&&this.direction!=0){if(this.stoptimer){clearTimeout(this.stoptimer)}this.timer=window.setTimeout("carousel.play();",this.accelerate);this.isRunning=true;this.stoptimer=0;return}else{if(this.isRunning&&this.accelerate==0&&this.direction==0){this.stop();return}else{if(!this.isRunning&&this.accelerate==0&&this.direction==0){return}}}clearTimeout(this.timer);var g=$("#"+this.options.id);var f=$(g.children("div")[0]);var d=$(g.children("div")[6]);var b=parseInt(this.direction>0?d.attr("data-index"):f.attr("data-index"));b=(b+this.direction);if(b<=0){if(this.loop!==true){this.stop();return}b=this.options.maxCount}else{if(b==this.options.maxCount+1){if(this.loop!==true){this.stop();return}b=1}}var e=null;if(typeof this.options.loader=="function"){e=this.options.loader(b,this.direction)}if(!e){e=$('<div class="barcontainer"></div>')}e.attr("data-index",b);if(this.direction>0){e.css(this.getStyle(0));e.appendTo(g);var a=0;for(var c=Math.PI;c>=(Math.PI/8);c=c-(Math.PI/8)){$(g.children("div")[a]).animate(this.getStyle(c),this.accelerate);a++}e.animate(this.getStyle(Math.PI/8),this.accelerate,function(){for(var h=7;h<$("#"+carousel.options.id).children("div").length;h++){$($("#"+carousel.options.id).children("div")[0]).remove()}if(carousel.isRunning&&!carousel.stoptimer&&carousel.accelerate){carousel.timer=window.setTimeout("carousel.play();",carousel.accelerate)}})}else{if(this.direction<0){e.css(this.getStyle(Math.PI));e.insertBefore(f);var a=7;for(var c=0;c<(Math.PI);c=c+(Math.PI/8)){$(g.children("div")[a]).animate(this.getStyle(c),this.accelerate);a--}e.animate(this.getStyle(Math.PI-(Math.PI/8)),this.accelerate,function(){var h=$("#"+carousel.options.id).children("div");for(var i=7;i<h.length;i++){$(h[i]).remove()}if(carousel.isRunning&&!carousel.stoptimer&&carousel.accelerate){carousel.timer=window.setTimeout("carousel.play();",carousel.accelerate)}})}else{if(this.direction==0&&this.timer){clearTimeout(this.timer)}}}};this.stop=function(){if(this.timer){clearTimeout(this.timer)}if(this.stoptimer){clearTimeout(this.stoptimer)}this.isRunning=false;this.direction=0;this.accelerate=0;this.stoptimer=0;this.timer=0};this.handleEvent=function(b,d){if(d=="mouseover"){var c=(b.pageX-$("#"+this.options.id).position().left),a=0;if(c>this.maxLimit){a=1;this.accelerate=225}else{if(c<this.minLimit){a=-1;this.accelerate=225}}if(this.accelerate<0){this.accelerate*=-1}this.direction=a;if(this.direction==0){this.accelerate=0;this.stop()}else{if(!this.isRunning){this.play()}}}else{if(d=="mouseout"){if(!this.stoptimer){this.stoptimer=window.setTimeout("carousel.stop();",150)}}}}};
